#  Прогнозирование заказов такси
## Описание проекта
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Построим модель для такого предсказания.

Необходимо:

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.
## Описание данных
## Оценка
Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Получили 41.11.
## Ход работы и выводы по проекту
1. В ходе предобработки:
* привели столбец  `datetime` к соответствующему типу данных;
* не обнаружили дубликатов;
* обнаружили, что данные есть только за весну и лето 2018 года;
* ресемплировали данные по одному часу;

2. Выполнили анализ данных при помощи визуализации, отметили:
* временной ряд нестационарный;
* наблюдается тренд к увеличению;
* суточная сезонность, есть три отчетливых пика заказов:
    * около полуночи;
    * незадолго до полудня (примерно в 10 часов утра);
    * приблизительно в 15-16 часов.
* в сутках есть 2 небольших снижения (около 12 и 18 часов) и единственное резкое падение около 6 часов.

3. На основании результатов анализа добавили новые признаки:

   3.1. Календарные признаки:
    * день недели;
    * час.
    
    3.2. Предыдущие значения временного ряда с лагами 24 и 168.

   3.3. Скользящее среднее.

4. В пайплайне выполнили обучение и кроссвалидацию моделей:
    
    4.1. Обучили три разные модели:
    * `SVR`;
    * `LinearRegression`;
    * `DecisionTreeRegressor`.
    
    4.2. При помощи `RandomizedSearchCV()` выявили, что лучшей моделью для решения нашей задачи является `LGBMRegressor`. 

5. Проверили выбранную модель на тестовой выборке. 
    
    5.1. Полученная метрика меньше 48, качество модели удовлетворительное. 
    
    5.2. Проанализировали важность признаков для модели:
    * наиболее важными признаками для модели стали смещенное скользящее среднее и количество заказов в тот же час сутки назад;
    * с небольшим отрывом за ними следуют день недели и час;
    * еще несколько менее важным оказалось количество заказов в тот же час неделю назад. 
       
    Похоже, выявленные на этапе анализа суточные колебания оказывают больше влияния на количество заказов, чем прочие. Однако это заключение нужно делать осторожно, поскольку мы имеем дело с данными только весны и лета, зимой и осенью ситуация может выглядеть иначе.
    
    5.3. Проанализировали распределение остатков модели. Оно стремится к нормальному, но левый склон более пологий, и вершина смещена влево относительно нуля. Это говорит о том, что модель часто преуменьшает количество заказов.
    Возможная причина - тренд к увеличению, который более выражен ближе к концу имеющегося временного ряда.
## Рекомендации
Обученную модель можно применять для прогнозирования количества заказов. При этом следует учитывать, что модель склонна преуменьшать.

Поскольку ближе к концу временного ряда появился тренд к увеличению, необходим повторный анализ и дообучение модели в ближайшем будущем.
