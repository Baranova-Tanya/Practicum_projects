# **Температура стали**

## Описание проекта
Металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали, чтобы оптимизировать производственные расходы. Для этого нужно контролировать температуру сплава. Задача — построить модель, которая будет предсказывать финальную температуру.

## Оценка
Средняя абсолютная ошибка не должна превышать 6.8.
На тестовой выборке получили 6.3.

## Ход работы и выводы по проекту
1. Все файлы загрузились нормально. Типы данных соответствуют ожиданиям. Дубликатов нет. Очень много значений пропущено в данных о подаче сыпучих и проволочных материалов.
2. Потребовались группировка и агрегирование данных о температуре и об электродах.
3. Все данные во всех таблицах, содержащих информацию о времени, относятся к маю-сентябрю 2019 года.
4. Выявлены и удалены аномалии в данных о реактивной мощности и температуре. Выбросы не обрабатывали.
5. Сформировали таблицы `bulk_time_use` и `wire_time_use`, содержащие минимальное и максимальное время из таблиц `bulk_time` и `wire_time` для каждой партии.
6. Данные из таблиц `arc` и `temp` сгруппировали по партиям и выделили начальное и финальное измерение (проверили по времени начала и конца нагрева из таблицы `arc`, а также по данным из таблиц `bulk_time_use` и `wire_time_use`).
7. Сформировали таблицы `bulk_use` и `wire_use` путем удаления столбцов, в которых присутствовало менее 50 значений. Заполнили пропуски нулями.
8. Сформировали из имеющихся признаков новые: 
    - суммарная полная мощность;
    - общее время нагрева дугой;
    - количество итераций нагрева дугой;
    - первая измеренная температура;
    - последняя измеренная температура (целевой признак);
    - средняя температура промежуточных измерений.
9. Удалили строки, не пригодные для обучения. Итоговый датасет для обучения содержит 2327 строк.
10. В ходе исследовательского анализа обнаружили:
    - чаще всего на партию приходится 4-5 итераций нагрева, у многих партий итераций оказывается 3 или 6. Другие варианты (1-2, 7-16) редки;
    - все признаки распределены нормально и содержат некоторое число выбросов. 
11. Распределение `sum_full_power` нормальное с крутыми симметричными склонами и вершиной около 3.8, присутствует небольшое число выбросов справа.
12. Распределение `sum_time_heating` нормальное с крутыми симметричными склонами и вершиной около 800, присутствуют выбросы справа до 3000, а также одиночное значение больше 4000.
13. Распределение `first_measure_temp` похоже на нормальное, бимодальное с почти симметричными вершинами около 1575 и 1590. Выбросов практически нет: их мало, и они близки к основной массе значений.
14. Распределение `rest_mean_temp` похоже на нормальное, вершина около 1588, медиана очень близка к среднему. Небольшое число выбросов с обеих сторон.
15. Распределения в данных о подаче сыпучих и проволочных материалов в основном похожи на нормальные (в тех столбцах, где достаточно данных, чтобы судить об этом), иногда би- и полимодальные. Почти во всех есть некоторое количество выбросов справа. 
16. Распределение целевого признака `last_measure_temp` похоже на нормальное, бимодальное с основной вершиной около 1595 и небольшим подъемом около 1615. Заметное число выбросов справа и слева.
17. В ходе корреляционного анализа обнаружили:
    - несколько входных признаков имеют сильные линейные взаимосвязи между собой:
        - `max_cum_count` и `sum_full_power`;
        - `bulk_11`, `wire_6` и `wire_2`.
18. Устранили мультиколлинеарность, удалив наименее ценные для обучения признаки из имеющих сильные взаимосвязи друг с другом. 
19. В итоговый датасет вошли следующие признаки:
- входные:
    - 'sum_full_power';
    - 'sum_time_heating';
    - 'bulk_1';
    - 'bulk_3' - 'bulk_6';
    - 'bulk_10';
    - 'bulk_12';
    - 'bulk_14' - 'bulk_15';
    - 'wire_1';
    - 'wire_3';
    - 'wire_6';
    - 'gas';
    - 'first_measure_temp';
    - 'rest_mean_temp';
- целевой `last_measure_temp`.
20. Разделили данные на тренировочную и тестовую выборку в соотношении 3:1.
21. Заполнили оставшиеся пропуски нулями.
22. Составили пайплайн для масштабирования данных и обучения трех разных регрессионных моделей с подбором гиперпараметров:
    - масштабирование:
        - `StandardScaler()`;
        - `MinMaxScaler()`;
    - обучаемые модели:
        - `LinearRegression()`;
        - `SVR()` (с вариантами гиперпараметров);
        - `LGBMRegressor()` (с вариантами гиперпараметров).
23. Выбрали лучшую модель методом `RandomizedSearchCV()`.
24. Лучшая модель - `LGBMRegressor()` с типом бустинга `Gradient Boosting Decision Tree` и препроцессором `MinMaxScaler()`. Средняя абсолютная ошибка на кроссвалидации приблизительно 6.4, что лучше требуемого 6.8.
25. Проверили лучшую модель на тестовой выборке и получили среднюю абсолютную ошибку также приблизительно 6.3.
26. Проанализировали важность признаков для модели:
    - наиболее важные признаки для модели:
        - `first_measure_temp` (с заметным отрывом от других признаков);
        - `sum_time_heating`;
        - `wire_1`;
        - `gas`;
        - `rest_mean_temp`;

    - наименее значимые признаки:
        - `wire_6`;
        - `wire_3`;
        - `bulk_5`;
        - `bulk_10`;
        - `bulk_1`.
27. Проанализировали остатки модели:
    - они распределены нормально,  почти симметрично относительно нуля, с маленьким смещением влево. Значит, модель склонна чуть чаще завышать предсказания температуры, чем занижать; 
    - дисперсия не сильно различается для разных предсказаний модели, то есть модель ошибается приблизительно равномерно.

## Рекомендации
1. Желательно ввести регламент сбора данных, чтобы для всех партий во всех таблицах данные указывались в одинаковой последовательности, а ключевые данные не оказывались пропущенными.
2. Для предсказания конечной температуры можно использовать обученную нами модель. Она продемонстрировала качественные прогнозы.
