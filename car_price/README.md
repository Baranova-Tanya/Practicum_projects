# Определение стоимости автомобилей
## Описание проекта
Сервис по продаже автомобилей с пробегом "Не бит, не крашен" разрабатывает приложение для привлечения новых клиентов. В нем можно быстро узнать рыночную стоимость своего автомобиля. Даны исторические данные: технические характеристики, комплектации и цены автомобилей. Нужно построить модель для определения стоимости. 

Попробуем обучить две модели: `LightGBM` и `SVR`. Выберем наилучшую с учетом требований заказчика. 
## Описание данных
Дана одна таблица (файл `autos.csv`) со следующими признаками:

|название столбца|содержащиеся данные|
|:-|:-|
|`DateCrawled`|дата скачивания анкеты из базы|
|`VehicleType`|тип автомобильного кузова|
|`RegistrationYear`|год регистрации автомобиля|
|`Gearbox`|тип коробки передач|
|`Power`|мощность (в лошадиных силах)|
|`Model`|модель автомобиля|
|`Kilometer`|пробег (в километрах)|
|`RegistrationMonth`|месяц регистрации автомобиля|
|`FuelType`|тип топлива|
|`Brand`|марка автомобиля|
|`Repaired`|была машина в ремонте или нет|
|`DateCreated`|дата создания анкеты|
|`NumberOfPictures`|количество фотографий автомобиля|
|`PostalCode`|почтовый индекс владельца анкеты (пользователя)|
|`LastSeen`|дата последней активности пользователя|
|`Price`|цена (в евро), **целевой признак**|

## Оценка
Заказчик отметил, что для него важны:

- качество предсказания (значение метрики *RMSE* должно быть меньше 2500);
- скорость предсказания;
- время обучения.
## Ход работы и выводы по проекту
1. В ходе анализа и предобработки данных:
* обнаружили очень большое количество пропусков, аномалий и выбросов, 4 дубликата;
* удалили 11% строк;
* исключили из анализа и обучения признаки, не имеющие значения для целей проекта:
  - `DateCrawled`;       
  - `RegistrationMonth`;  
  - `DateCreated`; 
  - `NumberOfPictures`;   
  - `PostalCode`;  
  - `LastSeen`;
* пропуски в категориальных и количественных признаках частично восстановили модой для каждой модели;
* пропуски, которые не удалось восстановить, заменили на `unknown`;
* отметили, что все потенциальные входные признаки имеют взаимосвязи с целевым признаком, но особенно сильной взаимосвязи у `Price` нет ни с одним из признаков.
2. Обучили и проанализировали 2 модели: `SVR` и `LGBMRegressor` (для них потребовалось использовать различные способы обработки). Только `LGBMRegressor` показала на валидационной выборке метрику *RMSE* меньше требуемых 2500. Она же оказалась гораздо быстрее. А также ее остатки более нормально распределены. Модель `LGBMRegressor` оказалась лучшей из рассмотренных.
3. Проверили `LGBMRegressor` на тестовой выборке и проанализировали важность признаков. Наиболее важными оказались год регистрации, мощность двигателя и модель/бренд.

## Рекомендации
Обученную модель можно применять для определения цены.

Желательно в будущем унифицировать названия категорий топлива. Возможно, имеет смысл сделать пробег категориальным признаком. 

Для дальнейшего улучшения метрик может оказаться полезным отдельно рассматривать цены на винтажные автомобили в хорошем состоянии, почти новые автомобили, автомобили с большим пробегом и потенциальные запчасти. Для каждой из этих категорий можно было бы построить отдельную модель, поскольку ценообразоавние в них очень разное.
